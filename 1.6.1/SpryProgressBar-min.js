/* Copyright Arnout Kazemier, license: github.com/3rd-Eden/Spry-UI-ProgressBar, version: 0.0 for Spry 1.6.1 */var Spry;Spry||(Spry={});if(!Spry.Widget)Spry.Widget={};Spry.Widget.ProgressBar=function(a,b){var d=this;Spry.Utils.Notifier.call(this);Spry.Widget.ProgressBar.setOptions(this,Spry.Widget.ProgressBar.config);Spry.Widget.ProgressBar.setOptions(this,b);this.version="0.1.0";this.element=Spry.$$(a)[0];this.bar=Spry.$$("."+this.barClass,this.element);this.currentWidth=this.initialWidth=Spry.Effect.getDimensionsRegardlessOfDisplayState(this.bar[0],this.displayElement||this.bar[0]).width;this.counter=0;this.bar.setStyle("width:"+(this.currentWidth=this.currentWidth/100*this.percentage)+"px");this.autoStart&&this.setPercentage(100,this.duration);this.addObserver({onComplete:function(){d.hideOnComplete&&d.hide()}})};Spry.Widget.ProgressBar.defaultEaseFunc=function(a,b,d,c){if(a>c)return d+b;return b+a/c*d};Spry.Widget.ProgressBar.config={percentage:0,transition:Spry.Widget.ProgressBar.defaultEaseFunc,duration:2E3,autoStart:false,hideOnComplete:true,barClass:"bar"};Spry.Widget.ProgressBar.setOptions=function(a,b,d){if(b){var c;for(c in b)d&&b[c]=="undefined"||(a[c]=b[c])}};Spry.Widget.ProgressBar.prototype=new Spry.Utils.Notifier;Spry.Widget.ProgressBar.prototype.constructor=Spry.Widget.ProgressBar;Spry.Widget.ProgressBar.prototype.setPercentage=function(a,b,d){a=this.cleanPercentage(a);b=typeof b!=="number"?this.duration:b;var c=this,h=a>=this.percentage,i=this.initialWidth/100*a,k=h?a-this.percentage:this.percentage-a;this.effect=new Spry.Effect.Slide(this.bar[0],{duration:b,from:this.currentWidth+"px",to:i+"px",horizontal:true,transition:this.transition,finish:d||null});this.currentWidth=i;this.percentage=a;this.effect.addObserver({onPostEffect:function(){a===100&&c.notifyObservers("onComplete");c.notifyObservers("onPercentageChanged",c.counter=a);c.notifyObservers("onPercentageSet",c.percentage)},onStep:function(e,j){if(j.getElapsedMilliseconds()>=e.increase&&!(c.counter>=100)){e.increase=e.avg+e.increase;var f=Math.floor(j.getElapsedMilliseconds()/e.avg),g;if(!e.percent||e.percent<f){g=f-e.percent||1;e.percent=f;c.notifyObservers("onPercentageChanged",c.counter=c.cleanPercentage(h?c.counter+g:c.counter-g))}}}});this.effect.avg=this.effect.increase=Math.round(b/k);this.effect.start()};Spry.Widget.ProgressBar.prototype.stop=function(){this.effect.stop()};Spry.Widget.ProgressBar.prototype.start=function(){this.effect.start()};Spry.Widget.ProgressBar.prototype.add=function(a,b){a=a?this.cleanPercentage(a):5;this.setPercentage(this.counter+a,b)};Spry.Widget.ProgressBar.prototype.remove=function(a,b){a=a?this.cleanPercentage(a):5;this.setPercentage(this.counter-a,b)};Spry.Widget.ProgressBar.prototype.reset=function(){var a=this;this.hidden&&this.show();this.counter=0;this.setPercentage(0,1,function(){a.notifyObservers("onReset")})};Spry.Widget.ProgressBar.prototype.complete=function(a){this.setPercentage(100,a||200)};Spry.Widget.ProgressBar.prototype.cleanPercentage=function(a){a=typeof a==="number"?a:parseFloat(a.replace(/\%/g,""));return a>100?100:a<0?0:a};Spry.Widget.ProgressBar.prototype.getPercentage=function(a){return a?this.percentage:this.counter};Spry.Widget.ProgressBar.prototype.show=function(){if(this.hidden){this.hidden=false;this.element.style.display="";Spry.Effect.DoFade(this.element,{from:0,to:100,duration:500})}};Spry.Widget.ProgressBar.prototype.hide=function(){var a=this;this.hidden=true;Spry.Effect.DoFade(this.element,{from:100,to:0,duration:500,finish:function(){a.element.style.display="none"}})};